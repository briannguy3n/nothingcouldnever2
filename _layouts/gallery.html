---
layout: no-header
---

<div class="gallery-content">
  <h1>{{ page.title }}</h1>
  
  <div class="gallery-grid">
    {% for file in site.static_files %}
      {% if file.path contains 'assets/img/gallery/' %}
        {% assign file_ext = file.path | split: '.' | last | downcase %}
        {% if file_ext == 'jpg' or file_ext == 'jpeg' or file_ext == 'png' or file_ext == 'gif' or file_ext == 'webp' %}
          {% assign description = page.descriptions[file.name] %}
          <div class="gallery-item">
            <img data-src="{{ site.baseurl }}{{ file.path }}" 
                 alt="" 
                 class="gallery-thumbnail lazy-image"
                 data-full="{{ site.baseurl }}{{ file.path }}"
                 data-description="{{ description }}"
                 loading="lazy">
          </div>
        {% endif %}
      {% endif %}
    {% endfor %}
  </div>
</div>

<!-- Lightbox Modal -->
<div id="lightbox" class="lightbox">
  <span class="lightbox-close">&times;</span>
  <img class="lightbox-content" id="lightbox-img">
  <div class="lightbox-caption" id="lightbox-caption"></div>
  <a class="lightbox-prev">&#10094;</a>
  <a class="lightbox-next">&#10095;</a>
</div>

<script src="{{ site.baseurl }}/assets/js/lightbox.js"></script>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const gallery = document.querySelector('.gallery-grid');
    const items = Array.from(gallery.children);
    
    // Fisher-Yates shuffle algorithm
    for (let i = items.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [items[i], items[j]] = [items[j], items[i]];
    }
    
    // Re-append items in shuffled order
    items.forEach(item => gallery.appendChild(item));
    
    // Lazy loading with Intersection Observer
    const lazyImages = document.querySelectorAll('.lazy-image');
    
    // Configuration for the observer
    const imageObserverOptions = {
      root: null, // viewport
      rootMargin: '50px', // start loading 50px before image enters viewport
      threshold: 0.01
    };
    
    // Callback function when image intersects
    const imageObserver = new IntersectionObserver((entries, observer) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          const img = entry.target;
          const src = img.getAttribute('data-src');
          
          if (src) {
            img.src = src;
            img.classList.add('loaded');
            observer.unobserve(img); // Stop observing once loaded
          }
        }
      });
    }, imageObserverOptions);
    
    // Start observing all lazy images
    lazyImages.forEach(img => imageObserver.observe(img));
  });
</script>
